å°æ ·æœ¬åˆ†å‰²ï¼ˆFew shot segmentation, FSSï¼‰é¢†åŸŸideaæ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„å‡ ç¯‡è®ºæ–‡æ•´ç†ã€‚



**OSLSM** 2017 ï¼ˆæœ€æ—©ç”¨Pascal 5iåšäº¤å‰éªŒè¯ï¼Œweight hashingï¼Œsupå’Œqueæœ€ç»ˆç‰¹å¾åšwå’Œbè¿›è¡Œlogisticå›å½’ï¼‰

**SG-One** 2018 ï¼ˆmask pooling + cosine simï¼‰

**Prototype Alignment Network (PANet)** 2019 ï¼ˆalignmentï¼Œä¸€ç§ç±»cycle lossï¼‰

**FSS-1000ï¼ˆrelation netï¼‰** 2019 ï¼ˆä¸»è¦æ˜¯æ•°æ®é›†FSS-1000ï¼Œé€‚ç”¨äºå°æ ·æœ¬åˆ†å‰²çš„æ•°æ®é›†ï¼‰

**CANet: Class-Agnostic Segmentation** 2019ï¼ˆå¯¹ç»“æœè¿›è¡Œ refinementï¼‰

**BMVC 2018**  2018ï¼ˆç½‘ç»œè®¾è®¡è¾ƒå¤æ‚ï¼‰

**Prototype Mixture Modelsï¼ˆPMMï¼‰** 2020  ï¼ˆå°†prototypeæ‹†æˆå¤šä¸ªï¼‰

**Prior Guided Feature Enrichment Networkï¼ˆPFENetï¼‰** 2020ï¼ˆå…ˆç”Ÿæˆæ— é¡»è®­ç»ƒçš„priorï¼Œåæ¥å¤šç‰¹å¾èåˆï¼‰

**FSILï¼ˆFew shot Seg Image Levelï¼‰** 2020 ï¼ˆåˆ©ç”¨image-levelçš„å¼±ç›‘ç£ä¿¡æ¯åšfew shot segï¼‰



---

####  One-shot learning for semantic segmentationï¼ˆOSLSMï¼‰

ã€BMVC 2017ã€‘

BMVC 2017çš„papercodeï¼šhttps://github.com/lzzcd001/OSLSM æœ€æ—©åˆ©ç”¨supportç›‘ç£ç”Ÿæˆpredictionçš„æ–‡ç« ã€‚ä¹‹å‰éƒ½æ˜¯åŸºäºå¯¹supportè¿›è¡Œfinetuneå®ç°few shot learningã€‚PASCAL 5içš„åˆ’åˆ†æ–¹å¼å’Œbenchmarkå°±æ˜¯ç”±è¯¥paperè®¾ç½®ã€‚ é¢˜ç›®æ˜¯one shotï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥å¤„ç†k-shotï¼Œåªä¸è¿‡ä»ç„¶æ˜¯ä»¥one-shotå½¢å¼é€ä¸ªè¿›è¡Œï¼Œç„¶åå°†æ‰€æœ‰çš„ç»“æœè¿›è¡ŒORè¿ç®—ï¼Œå¾—åˆ°æœ€ç»ˆçš„åˆ†å‰²è¾“å‡ºã€‚ ç½‘ç»œç»“æ„ï¼š  



![53AE8C63-EB51-4DEE-9112-B3E581365ABC](assets/53AE8C63-EB51-4DEE-9112-B3E581365ABC.png)

å…·ä½“å®ç°æ–¹æ³•ï¼š 

![80C50690-671C-42C1-9646-057C38D2C8BB](assets/80C50690-671C-42C1-9646-057C38D2C8BB.png)

é¦–å…ˆï¼Œç”¨vggå¯¹support imgæç‰¹å¾ï¼Œå¾—åˆ°1000ç»´çš„vecï¼Œ ç„¶åé€šè¿‡weight hashingï¼Œæ‰©å……åˆ°4096ç»´ã€‚å¯¹äºqueryï¼Œè¿›å…¥FCN-32sï¼Œå¾—åˆ°fc7çš„featureï¼Œä¹Ÿæ˜¯4096ç»´ï¼Œç„¶åå°†condition brachï¼Œå³supportçš„ç‰¹å¾å‘é‡ä½œä¸ºwå’Œbï¼Œå’Œqueryçš„feature mapåšpixel wiseçš„logistic regï¼Œç„¶åä¸Šé‡‡æ ·è¾“å‡ºåˆ†å‰²ç»“æœã€‚ losså‡½æ•°å°±æ˜¯logä¼¼ç„¶ã€‚ä¸‹é™æ–¹æ³•ç”¨SGDï¼Œå¹¶ä¸”ç”±äºVGGæ¯”fcå±‚overfitæ›´å¿«ï¼Œå› æ­¤å¯¹learning rateè¿›è¡Œäº†è°ƒæ•´ã€‚ OSLSMç”¨çš„backboneä¸ºvggï¼Œè€Œä¸”åˆ†å‰²ç½‘ç»œFCNï¼Œç°åœ¨çœ‹æ¥æ•ˆæœéƒ½å—åˆ°é™åˆ¶ï¼Œæœ€ç»ˆçš„ç»“æœå¦‚ä¸‹ï¼š

![882AF57E-7BBD-4E2F-B914-D2DC165B8AB4](assets/882AF57E-7BBD-4E2F-B914-D2DC165B8AB4.png)



---

#### SG-One: Similarity Guidance Network for One-Shot Semantic Segmentation

ã€IEEE Transactions on Cybernetics 2018ã€‘



![82F03054-CADC-4DBB-90A4-B0609F9FDA6F](assets/82F03054-CADC-4DBB-90A4-B0609F9FDA6F.png)

æœ¬æ–‡æ–¹æ³•ç›¸å¯¹æ¯”è¾ƒæ—©ï¼Œå› æ­¤ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç½‘ç»œç»“æ„å¦‚ä¸‹

![2BA24583-19C1-4C90-B431-C4AA11626778](assets/2BA24583-19C1-4C90-B431-C4AA11626778.png)

å…¶ä¸­ï¼Œï¼ˆ sup img, sup mask ï¼‰å’Œ que imgä¸€èµ·ä½œä¸ºä¸€ä¸ªepisodeï¼Œå°†supå’Œqueçš„imgè¿‡ä¸€ä¸ªguidance branchçš„ç½‘ç»œï¼Œque imgå¾—åˆ°çš„æ˜¯å„ä¸ªpixelçš„feature vecï¼Œsup imgé€šè¿‡interpå’Œmask avg poolingï¼Œå¾—åˆ°prototypeã€‚æœ€åï¼Œå°†feature vecä¸prototypeè¿›è¡Œcosineç›¸ä¼¼åº¦è®¡ç®—ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ª[-1, 1]ä¹‹é—´çš„ç›¸ä¼¼åº¦mapã€‚é™¤äº†guidance branchï¼Œè¿˜ç”¨å¦ä¸€ä¸ªç½‘ç»œåšå®é™…çš„segmentationï¼Œå°†cosine ç›¸ä¼¼åº¦mapä¹˜åˆ°ä¸‹é¢çš„feature mapä¸­ï¼Œä¼˜åŒ–æœ€ç»ˆçš„predictionï¼Œå³å’Œque maskè®¡ç®—cross entropyã€‚

è¿™ä¸ªæ–¹æ³•å¤©ç„¶å°±æ˜¯one shotä»»åŠ¡çš„ï¼Œå¦‚æœæ˜¯K shotï¼Œå¯ä»¥è¿™æ ·å¤„ç†ï¼š

![7BAA57F1-BA4F-4046-995B-EFBEF46F03F8](assets/7BAA57F1-BA4F-4046-995B-EFBEF46F03F8.png)

ä¹Ÿå¯ä»¥ç›´æ¥å¹³å‡K representation vectorsï¼Œç„¶åç”¨avgæ¥ä½œä¸ºguidanceã€‚





---

#### PANet: Few-Shot Image Semantic Segmentation with Prototype Alignment

ã€ICCV 2019ã€‘



prototypeç±»æ–¹æ³•å®é™…ä¸Šå°±æ˜¯å°†ä¸€ä¸ªä¼ ç»Ÿçš„segmentæ¨¡å‹åˆ†æˆäº†ä¸¤ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œå³ï¼šprototype extractionå’Œnon-parameteric metric learningã€‚protoçš„ä½œç”¨å°±æ˜¯ç”Ÿæˆä¸€ä¸ªrepresentationã€‚

![202BFC24-E6A4-4EB9-A5AA-382494FB6521](assets/202BFC24-E6A4-4EB9-A5AA-382494FB6521.png)

 **Prototype Alignment Network** **(PANet)**

æœ¬æ–‡çš„æ–¹æ³•é€šè¿‡reverseçš„è¿‡ç¨‹ï¼Œç”¨queryå’Œå¯¹åº”çš„predicted maskå­¦ä¹ ï¼Œå»segment support setçš„æ ·æœ¬ã€‚ä»è€Œä½¿å¾—æ¨¡å‹generateå‡ºå¯¹äºsupportå’Œqueryæ¯”è¾ƒä¸€è‡´çš„prototypeã€‚ å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š

![80FCEB36-2013-437D-998C-9A98040A11E8](assets/80FCEB36-2013-437D-998C-9A98040A11E8.png)

å¦‚æœåªçœ‹å·¦è¾¹ä¸€éƒ¨åˆ†ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªbaseç‰ˆæœ¬çš„protonetçš„æ–¹æ³•ï¼Œå³ä»supporté‡Œå­¦å„ä¸ªprototypeï¼Œç„¶åï¼Œé€šè¿‡æ— å‚æ•°çš„metric classificationï¼Œå°†queryæ•°æ®è¿›è¡Œåˆ†ç±»ã€‚ä½†æ˜¯PANetåˆè¿›è¡Œäº†å¦ä¸€æ­¥éª¤ï¼Œå³ä»queryçš„predict maskå¼€å§‹ï¼Œå°†å®ƒä½œä¸ºçœŸå®çš„maskï¼Œç„¶åç”Ÿæˆqueryçš„prototypeï¼Œè¿”å›å»å¯¹supportè¿›è¡Œé¢„æµ‹ï¼Œå†å’Œsupportçš„gtè¿›è¡Œæ¯”è¾ƒã€‚äºæ˜¯å¾—åˆ°äº†æ­£å‘å’Œåå‘çš„ä¸¤ä¸ªlossã€‚æœ‰ç‚¹ç±»ä¼¼cycleGANçš„æ€æƒ³ã€‚ è¿™ä¸ªç­–ç•¥è¢«å«åš**PARï¼šprototype alignment regularization**ï¼Œç”¨æ¥çº¦æŸembedå¾—åˆ°çš„prototypeæ›´åŠ consistent å’Œ robustã€‚ 

Prototype learningä¸­å¯¹äºmaskçš„ä½¿ç”¨ï¼šé¦–å…ˆï¼Œ åœ¨æœ€åˆå–‚è¿›ç½‘ç»œæ—¶è¿›è¡Œmaskï¼Œåªä¿ç•™å½“å‰çš„classï¼ˆearly fusionï¼‰ï¼›å¦å¤–ï¼Œåœ¨ç”Ÿæˆäº†feature mapä»¥åï¼Œå†è¿›è¡Œmaskï¼Œç›´æ¥åˆ†ç¦»å¼€BGå’ŒFGï¼Œç”Ÿæˆä¸¤è€…çš„prototypeï¼ˆlate fusionï¼‰ã€‚æœ¬æ–‡é‡‡ç”¨äº†ç¬¬äºŒç§ï¼Œå³late fusionã€‚

 Non-parametric metric learningï¼šä¸å„ä¸ªprototypeåˆ†åˆ«è®¡ç®—è·ç¦»ï¼Œå¹¶softmax over classesï¼ˆprotosï¼‰ï¼š

![image-20210630170621934](assets/image-20210630170621934.png)

è·ç¦»å‡½æ•°ç”¨çš„æ˜¯cosineè·ç¦»ï¼Œcosè·ç¦»æ›´stableï¼Œæ•ˆæœç›¸å¯¹æ›´å¥½ã€‚ PANetçš„lossç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œseg losså’ŒPAR lossï¼š

![image-20210630170644495](assets/image-20210630170644495.png)             

æ•´ä½“ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š

![31F78412-6EED-4FD2-921D-B9592EC2170F](assets/31F78412-6EED-4FD2-921D-B9592EC2170F.png)

è¯¥æ–¹æ³•ä¹Ÿæ”¯æŒå¼±æ ‡ç­¾ï¼š

![8DD48997-E36C-4107-A6C2-35778D964446](assets/8DD48997-E36C-4107-A6C2-35778D964446.png)



---

#### FSS-1000: A 1000-Class Dataset for Few-Shot Segmentation

ã€CVPR 2019ã€‘

FSS-1000æ˜¯ä¸ºfew shot é—®é¢˜ä¸“é—¨è®¾è®¡çš„datasetã€‚å®ƒå…±æœ‰1kç±»ï¼Œä½†æ˜¯æ¯ä¸ªç±»åˆ«åªæœ‰10å¼ å›¾ï¼Œæ€»å…±æœ‰1wå¼ å›¾ç‰‡ã€‚ 

![1F98155E-9F63-464F-A57E-D48C0F3A3293](assets/1F98155E-9F63-464F-A57E-D48C0F3A3293.png)

å’Œé€šå¸¸ç”¨çš„pascal å’Œ cocoç›¸æ¯”ï¼ŒFSS-1000ç±»åˆ«å¤šï¼Œè€Œä¸”å„ç±»æ•°é‡åˆ†å¸ƒå¹³å‡ã€‚å¹¶ä¸”åŒ…å«äº†ä¸€äº›å…¶ä»–æ•°æ®é›†ä¸­æ²¡æœ‰çš„ç±»åˆ«ã€‚

![D9909601-0160-4D2C-AED9-DF1F2E557172](assets/D9909601-0160-4D2C-AED9-DF1F2E557172.png)

å¸¸è§æ•°æ®é›†éƒ½æˆ–å¤šæˆ–å°‘æœ‰é•¿å°¾æ•ˆåº”ï¼ŒFSSå„ç±»éƒ½ä¸€æ ·å¤šã€‚

![image-20210630174156411](assets/image-20210630174156411.png)

ä¸Šå›¾ä¸ºäº†å±•ç¤ºæ•°æ®é›†çš„æ•ˆæœã€‚åœ¨only FSS-1000ä¸Šè®­ç»ƒåï¼Œå†ç”¨pascal-5iè¿›è¡Œæµ‹è¯•ï¼Œæ¯”åœ¨pascalä¸Šè®­ç»ƒå¾—åˆ°çš„æ¨¡å‹æ•ˆæœè¿˜å¥½ã€‚è¯æ˜è¿™ä¸ªæ•°æ®é›†é€‚åˆåšfewshot segmentã€‚ support setä¸­çš„objectçš„ä½ç½®å’Œæœå‘å¾ˆé‡è¦ã€‚ä¸‹å›¾å±•ç¤ºçš„æ˜¯å¥½çš„support setä¸ä¸å¥½çš„support setå¾—åˆ°çš„ç»“æœã€‚

![image-20210630174215261](assets/image-20210630174215261.png)

åœ¨ä¸Šé¢çš„å®éªŒä¸­ï¼Œæ•°æ®é›†ä½œè€…ç”¨çš„baselineæ¨¡å‹å¦‚ä¸‹ã€‚æ¨¡å‹æ¯”è¾ƒç®€å•ï¼Œåˆ†ä¸‰ä¸ªéƒ¨åˆ†ï¼šencoderã€relationã€decoderã€‚ç”¨supportå’Œqueryåˆ†åˆ«è¿‡ä¸€éencoderï¼Œå¾—åˆ°çš„featureè¿›è¡Œrelationï¼Œå…¶å®å°±æ˜¯concatåè¿›è¡Œconvï¼Œå¾—åˆ°çš„ç»“æœè¿›å…¥decoderä¸­å¾—å‡ºæœ€åçš„predictionã€‚lossç”¨çš„æ˜¯bceã€‚æ•´ä¸ªè¿‡ç¨‹å¯ä»¥ç®€å•å†™æˆå¦‚ä¸‹å½¢å¼ï¼š 

![image-20210630174226660](assets/image-20210630174226660.png)

ç½‘ç»œç»“æ„å¦‚ä¸‹ï¼š

![26F4E999-735B-4211-B790-DB7898A211BD](assets/26F4E999-735B-4211-B790-DB7898A211BD.png)

å®éªŒbenchmarkçš„æ•°æ®é…ç½®ï¼š  For FSS-1000, we build the validation/test set by randomly sampling 20 distinct sub-categories from the 12 super-categories; the other images and labels are used in training. The train/validation/test split used in the experiments consists of 5,200/2,400/2,400 image and label pairs. å…±240ä¸ªtestç±»åˆ«ï¼Œå…¶ä½™760ç±»ä½œä¸ºtrainvalï¼Œå…¶ä¸­520ä¸ªè®­ç»ƒï¼Œ240ä¸ªéªŒè¯ã€‚



---

#### CANet: Class-Agnostic Segmentation Networks with Iterative Refinement and Attentive Few-Shot Learning

ã€CVPR 2019ã€‘ 



 CANetçš„åŸºæœ¬æ€è·¯æ˜¯é€šè¿‡å­¦ä¹ ä¸€ä¸ªsupportå’Œqueryçš„multi-level feature comparisonï¼Œç„¶åå¯¹ç»“æœè¿›è¡Œiterative refineï¼Œæœ€ç»ˆå¾—åˆ°prediction maskã€‚ç»“æ„å¦‚ä¸‹ï¼š 

![551B02BF-D778-47F8-92B0-BA9C2B7B0718](assets/551B02BF-D778-47F8-92B0-BA9C2B7B0718.png)



DCMï¼šdense comparison moduleIOMï¼šiterative optimization module è¿™é‡Œçš„dense comparisonå®é™…ä¸Šå°±æ˜¯masked average pooling of support featuresã€‚è€ƒè™‘åˆ°transferableçš„ç›®çš„ï¼Œmiddle-levelçš„ç‰¹å¾ç›¸æ¯”äºlowå’Œhigh levelï¼ˆclass-specificï¼‰æ›´æœ‰æ•ˆã€‚æœ€ç»ˆåœ¨dense comparisonæ—¶ç”¨çš„æ˜¯multi-levelçš„ç‰¹å¾ã€‚ ç”±äºcategoryç»„å†…æ–¹å·®çš„å½±å“ï¼Œåªåšcomparisonå¹¶ä¸å……åˆ†ï¼Œå› æ­¤å†åé¢å¢åŠ äº†refinementé˜¶æ®µï¼Œå³IOMã€‚ç”¨äºç”Ÿæˆfine-grained maskã€‚ CANetçš„ä¸€ä¸ªæ–°çš„ç‰¹æ€§ï¼šå¯ä»¥ç”¨weak annotationä½œä¸ºlabelï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°pixel-wise labelçš„supportçš„ä¸€ä¸ªcomparable performanceã€‚å®éªŒæ˜¾ç¤ºï¼Œåœ¨æ¢æˆbox annotationåï¼Œåªæ‰äº†ä¸¤ä¸ªç‚¹ï¼š 

![E1056F5E-A7E1-4E0D-9129-05BC2AE5D252](assets/E1056F5E-A7E1-4E0D-9129-05BC2AE5D252.png)

one-shotæƒ…å†µä¸‹çš„ç½‘ç»œç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š

![5B7282C0-304A-4FED-8F34-5E9845E6462C](assets/5B7282C0-304A-4FED-8F34-5E9845E6462C.png)



DCMé˜¶æ®µå°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„protonetçš„æ–¹æ³•ï¼Œå…ˆè¿‡ä¸€ä¸ªfeature extractorï¼Œç„¶åå¯¹supportåšmasked average poolingï¼Œå¾—åˆ°prototypeï¼Œå†ä¸queryè¿›è¡Œæ¯”å¯¹ã€‚è¿™é‡Œä½¿ç”¨äº†resnetçš„block2å’Œ3ï¼Œå³ä¸­é—´çš„midlevel featureã€‚ä¹‹åéƒ½ä½¿ç”¨dilated convä¿æŒåˆ†è¾¨ç‡ã€‚ IOMé˜¶æ®µçš„æ“ä½œå¦‚ä¸‹ï¼šé¦–å…ˆï¼Œå°†æå–åˆ°çš„feature mapä¸ä¸Šä¸€ä¸ªiterationå¾—åˆ°çš„prediction maskè¿›è¡Œconcatï¼Œç„¶åç»è¿‡ä¸€ç³»åˆ—ç½‘ç»œï¼Œæœ€åå†é€šè¿‡ASPPè·å–multi-scaleä¿¡æ¯ï¼Œè¾“å‡ºprediction maskã€‚è¿™ä¸€æ­¥å¾—åˆ°çš„maskç»§ç»­åœ¨ä¸‹ä¸€æ¬¡iterationæ—¶å’Œæå–çš„feature mapç»“åˆï¼Œé‡æ–°è¿›è¡Œrefineã€‚å¦å¤–ï¼Œåœ¨è®­ç»ƒä¸­ï¼Œæœ‰ä¸€å®šçš„æ¦‚ç‡å°†prediction maskç½®é›¶ï¼Œç±»ä¼¼äºdropoutï¼ˆå¯èƒ½æ˜¯ä¸ºäº†é˜²æ­¢åœ¨prediction maskä¸feature map concatçš„æ­¥éª¤ä¸­ï¼Œå­¦ä¹ åˆ°ä¸€ä¸ªä»predictionåˆ°predictionçš„é€šè·¯ï¼Œä»è€Œå¿½ç•¥äº†feature mapçš„æ›´æ–°ï¼‰ã€‚ ä»¥ä¸Šæ˜¯one-shotçš„æƒ…å†µï¼Œå¯¹äºk-shotï¼Œè¿˜éœ€è¦ä¸€ä¸ªattentionæ“ä½œï¼Œç”¨æ¥ç”Ÿæˆå„ä¸ªsupport sampleçš„weightï¼Œç”¨äºæœ€ç»ˆfeatureçš„mergeã€‚ï¼ˆæ‰€æœ‰æƒé‡éƒ½æ˜¯softmaxè¿‡çš„ï¼Œæœ€åä¹˜åˆ°å½“å‰sampleçš„featureä¸Šï¼‰

![8CF39A38-3379-4060-B355-8F1C785C6566](assets/8CF39A38-3379-4060-B355-8F1C785C6566.png)

 CANetåœ¨å‡ ä¸ªbenchmarkæ•°æ®é›†ä¸Šçš„ç»“æœï¼š 

![16C00344-85FC-4987-9FDB-0F230E1BD2F5](assets/16C00344-85FC-4987-9FDB-0F230E1BD2F5.png)

 FB-IoUæŒ‡çš„æ˜¯foreground-background iouï¼Œå³ä¸è€ƒè™‘ç±»åˆ«çš„iouã€‚ç”±äºæœ‰äº›objectä½“ç§¯å¾ˆå°ï¼Œå› æ­¤ï¼Œå³ä½¿æ²¡æœ‰é¢„æµ‹å‡ºobjectï¼Œå®ƒçš„backgroundå‡†ç¡®ç‡ä¾ç„¶å¾ˆé«˜ï¼ˆç±»ä¼¼äºæ•°æ®ä¸å‡è¡¡æ—¶å€™çš„accæŒ‡æ ‡ï¼‰ã€‚å› æ­¤ï¼ŒFB-IoUç›¸å¯¹ä¸å¤ªèƒ½ååº”çœŸå®æƒ…å†µï¼Œè€Œä¸”æ•°å€¼ä¸Šä¹Ÿæ¯”mean IOUè¦é«˜å¾ˆå¤šã€‚ CANetåœ¨PASCAL 5iæ•°æ®é›†ä¸Šçš„one-shot mean IoUè¾¾åˆ°55.4ã€‚ï¼ˆåœ¨PMMæ–‡ç« ä¸­æŠ¥çš„ç»“æœä¸º53.96ï¼Œç›¸å·®ä¸å¤§ï¼Œå¯èƒ½æ˜¯æ•°æ®é›†åŸå› ï¼‰



---

#### Few-Shot Semantic Segmentation with Prototype Learning

ã€BMVC 2018ã€‘



BMVC 2018 åŸºäºprototypeçš„æ€è·¯ï¼Œè¿™é‡Œçš„prototypeæŒ‡çš„æ˜¯ä¸€ä¸ªcategoryé‡Œé¢æœ€å…·æœ‰ä»£è¡¨æ€§çš„elementã€‚è¿™é‡ŒæŒ‡çš„æ˜¯å…·æœ‰high-level discriminative infoçš„featureã€‚ few shot çš„ training lossæ˜¯è¿™æ ·çš„ï¼š

![662B8F08-15DE-478F-BBCE-49A0F36335AD](assets/662B8F08-15DE-478F-BBCE-49A0F36335AD.png)

qä»£è¡¨queryï¼ŒSä»£è¡¨supportï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼˜åŒ–çš„æ˜¯åœ¨Sä¸Šè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹åœ¨xqå’Œyqä¸Šçš„cross entropyã€‚few shotçš„ä¸€ä¸ªepisodeè¡¨ç¤ºéšæœºé€‰æ‹©Nä¸ªclassï¼Œç„¶ååä»æ•´ä¸ªN-wayä¸­è¿›è¡Œæ ·æœ¬é€‰æ‹©ï¼Œæ„å»ºsupportå’Œqueryã€‚ç„¶åè¿›è¡Œä¼˜åŒ–ã€‚supportå’Œqueryéƒ½å‚ä¸è®­ç»ƒè¿‡ç¨‹ã€‚ æ¨¡å‹ç»“æ„ï¼š

![990389E8-B07B-4F36-B8F9-7025870D27E1](assets/990389E8-B07B-4F36-B8F9-7025870D27E1.png)

 åŸºæœ¬æµç¨‹ï¼šé¦–å…ˆï¼Œç”¨support setå’Œquery setè®­ç»ƒä¸€ä¸ªç½‘ç»œfthetaï¼Œåœ¨feature extractoråé¢æ¥ä¸€ä¸ªGAPæ¨¡å—ï¼Œç”Ÿæˆå„ä¸ªN-wayçš„prototypeã€‚ç„¶åï¼Œå°†prototypeåŠ å…¥åˆ°segmentorçš„è®­ç»ƒä¸­ï¼ˆä¹Ÿå°±æ˜¯béƒ¨åˆ†ï¼‰ï¼Œæ–¹æ³•æ˜¯å°†ä¸Šé¢å¾—åˆ°çš„prototypeè¿›è¡Œup poolingï¼Œç„¶åä¸g phiçš„è¾“å‡ºè¿›è¡Œaddæ“ä½œã€‚è¿™æ ·ï¼Œå°±å¯ä»¥å¾—åˆ°å„ä¸ªwayçš„feature mapäº†ï¼Œç„¶åå†åœ¨åé¢æ¥ä¸€ä¸ª1x1çš„convï¼Œå†è¿›è¡Œbilinear interpolationï¼Œå¾—åˆ°æœ€åçš„logitsï¼Œä¹Ÿå°±æ˜¯probability mapã€‚å°†è¿™ä¸ªprob mapé€šè¿‡åŠ æƒçš„æ–¹å¼è¿›è¡Œfusionï¼Œè·å¾—æœ€ç»ˆçš„ç»“æœã€‚è¿™äº›prob mapçš„è®­ç»ƒéœ€è¦å…ˆå’Œimgè¿›è¡Œç»„åˆæˆpairï¼Œç„¶åè¾“å…¥è¿›fï¼Œå³prototype learnerä¸­ï¼Œå°†å¾—åˆ°çš„feature vecä¸prototypeè®¡ç®—è·ç¦»ï¼Œä½œä¸ºåŠ æƒï¼Œå‚ä¸åˆ°segmentorçš„è®­ç»ƒä¸­ã€‚ ä¸‹é¢çœ‹å‡ ä¸ªlossï¼šé¦–å…ˆï¼ŒJ theta clsæ˜¯è®­ç»ƒprototypeçš„aux lossï¼Œ

![image-20210630171338844](assets/image-20210630171338844.png)

 å¸Œæœ›åˆ†ç±»å‡†ç¡®ã€‚è¿™é‡Œçš„p thetaæ˜¯é¢„æµ‹çš„queryä¸Šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œæ˜¯é€šè¿‡metricçš„æ–¹å¼å¾—åˆ°çš„ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼šsupportä¸Šçš„prototypeå¦‚ä¸‹ï¼š

![image-20210630171350113](assets/image-20210630171350113.png)

å¯¹äºqueryï¼Œå„ä¸ªç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒå¦‚ä¸‹å¾—åˆ°ï¼ˆmetric learningæ–¹å¼ï¼‰

![AF5E4494-E234-4D6A-A183-D1297D0DB6CD](assets/AF5E4494-E234-4D6A-A183-D1297D0DB6CD.png)

ä¸»ç½‘ç»œä¸­çš„prob mapåŠ æƒï¼š

![image-20210630171410340](assets/image-20210630171410340.png)

Permutation trainingï¼šæ¯æ¬¡è®­ç»ƒsegmentation modelä¹‹å‰ï¼Œå¯¹prototypeè¿›è¡Œé‡æ–°æ’åºï¼š

![0778F74E-EDEE-4EC8-B522-8D2348043DF8](assets/0778F74E-EDEE-4EC8-B522-8D2348043DF8.png)

 å®éªŒç»“æœï¼š

![A8626828-C986-4F6E-B1B2-9FC535FA0EFB](assets/A8626828-C986-4F6E-B1B2-9FC535FA0EFB.png)





---

#### Prototype Mixture Models for Few-shot Semantic Segmentation

ã€ECCV 2020ã€‘



 æœ¬æ–‡éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯GAPç”Ÿæˆprototypeæ—¶ï¼Œç”±äºä¸¢å¼ƒäº†ç©ºé—´åŸŸçš„å„ä¸ªpartçš„ä¿¡æ¯è€Œå¯¼è‡´çš„è¡¨ç¤ºèƒ½åŠ›çš„ä¸‹é™ã€‚ 



![21937525-7B84-4290-B7C7-739143059301](assets/21937525-7B84-4290-B7C7-739143059301.png)

![0B35D6CE-AA11-41D0-9DAB-EBC6962924CD](assets/0B35D6CE-AA11-41D0-9DAB-EBC6962924CD.png)

å¦‚å›¾ï¼Œå¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªobjectçš„åˆ†å¸ƒæ˜¯å¤šä¸ªpartç»„æˆçš„ï¼Œè€ŒGAPçš„prototypeåªèƒ½è¿›è¡Œå¹³å‡ï¼Œè€Œå¦‚æœå°†å„ä¸ªéƒ¨åˆ†åˆ†åˆ«å»ºæ¨¡ï¼Œè·å¾—å¤šä¸ªprototypeæ¥è¡¨å¾å„ä¸ªéƒ¨åˆ†çš„ç‰¹å¾ï¼Œé‚£ä¹ˆprototypeçš„è¡¨å¾èƒ½åŠ›æ›´å¼ºï¼Œè€Œä¸”åº”è¯¥å¯¹äºä½ç½®è§’åº¦å˜åŒ–æ›´åŠ é²æ£’ã€‚è¿™æ˜¯æœ¬æ–‡çš„åŸºæœ¬çš„intuitionã€‚ ç½‘ç»œç»“æ„å›¾ï¼š

![F586D662-8C4C-47EC-839E-A5A4CC7D00DC](assets/F586D662-8C4C-47EC-839E-A5A4CC7D00DC.png)

![F65B9D46-72F3-4B7C-A45F-2982F3F4618E](assets/F65B9D46-72F3-4B7C-A45F-2982F3F4618E.png)

è¿™é‡Œçš„P-Matchå³å°†prototype vecç›´æ¥ä¸Šé‡‡æ ·concatåˆ°query ç½‘ç»œä¸­ï¼Œè‡ªåŠ¨åœ°å­¦ä¹ é¢„æµ‹ã€‚è€ŒP-Convåˆ™æ˜¯ç›¸å½“äºä¸€ä¸ªè·ç¦»åº¦é‡çš„æ–¹æ³•ï¼Œå³æ‹¿å„ä¸ªprototype vecä¸Qçš„feature mapåšç‚¹ä¹˜ï¼Œç›¸å½“äºè®¡ç®—å‡ºäº†æ•´å¼ å›¾çš„æ¯ä¸ªpixelå¯¹äºå„ä¸ªproto vecçš„ç›¸å…³æ€§ï¼Œäºæ˜¯å¾—åˆ°äº†æ¯”è¾ƒç›´æ¥çš„prob mapã€‚ç„¶åå°†prob mapæ¥åˆ°query netçš„æœ€åï¼Œç”¨äºè¾“å‡ºã€‚ è¿™ä¸ªæ€è·¯ç®€å•æ¥è¯´å°±æ˜¯ä¸€æ–¹é¢å…ˆå°†proto vecä½œä¸ºfeature mapä½¿ç”¨ï¼Œå¦ä¸€æ–¹é¢åˆ™æ˜¯ä½œä¸ºçœŸæ­£çš„protoï¼ˆç±»ä¼¼knnçš„ä¸­å¿ƒç‚¹ï¼‰å»ç›´æ¥åšé¢„æµ‹ï¼Œç„¶åå°†ä¸¤è€…è¿›è¡Œåˆå¹¶ã€‚ä½œè€…ç§°ä¸ºï¼šPMM as representationå’Œ PMM as classifierã€‚ æ³¨æ„ï¼šp convçš„æ—¶å€™ï¼Œå¾—åˆ°çš„æ˜¯å„ä¸ªpartçš„protoçš„ç›¸å…³æ€§mapï¼Œå› æ­¤éœ€è¦è¿›è¡Œclass-wiseçš„summationï¼Œå¾—åˆ°å„ä¸ªç±»åˆ«çš„æœ€ç»ˆçš„prob mapã€‚ æœ¬æ–‡ç”¨çš„æ˜¯ä¸€ä¸ªmixture modelè¿›è¡Œå»ºæ¨¡ï¼Œè€ƒè™‘å‘é‡çš„è¡¨ç¤ºå½¢å¼ï¼Œæœ€ç»ˆå¯ä»¥å°†p(si | theta)æ”¹å†™æˆä¸‹é¢çš„å½¢å¼ï¼š

![image-20210630172011777](assets/image-20210630172011777.png)

 è¿™ä¸ªPMMï¼ˆprototype mixture modelï¼‰çš„optimizationè¿‡ç¨‹ç”¨çš„æ˜¯EMç®—æ³•ï¼š

![7059742F-358C-4FD1-8B35-6409EDF654AC](assets/7059742F-358C-4FD1-8B35-6409EDF654AC.png)

æ··åˆåˆ†å¸ƒä¸­çš„å„ä¸ªå‡å€¼ mu å®é™…ä¸Šå°±æ˜¯é€šè¿‡EMä¼˜åŒ–å‡ºæ¥çš„prototype vecã€‚æ•´ä¸ªç®—æ³•æµç¨‹æ¢³ç†ä¸€ä¸‹ï¼š å…ˆç”¨ç½‘ç»œä½œä¸ºfeature extractorï¼Œè·å¾—å„ä¸ªpixelçš„featureï¼Œé«˜ç»´åº¦ï¼Œä½œä¸ºå¤šä¸ªæ ·æœ¬ï¼Œè¿›è¡ŒEMï¼Œè·å¾—ä¼˜åŒ–åçš„prototype vecï¼Œç„¶ååŠ å…¥query netä¸­ï¼ˆé€šè¿‡pmatchå’Œpconvï¼‰ï¼Œå®é™…ä¸Šå°±æ˜¯ç”Ÿæˆä¸Šé¢çš„feature mapçš„é‚£ä¸ªç½‘ç»œï¼ˆweight sharingï¼‰ã€‚ç„¶åï¼Œç”¨ç½‘ç»œçš„forwardè·å¾—ä¸€ä¸ªpredictionï¼ˆqueryï¼‰ï¼Œå°±å¯ä»¥åšlossäº†ï¼Œç„¶åï¼Œå¯¹ç½‘ç»œè¿›è¡ŒBPï¼Œå®Œæˆä¸€è½®æ›´æ–°ã€‚æ›´æ–°åï¼Œå†å¯¹support çš„feature è¿›è¡Œæå–ï¼Œç»“æœå°±ä¸ä¸€æ ·äº†ï¼Œå› æ­¤éœ€è¦é‡æ–°EMï¼Œé‡æ–°forwardã€‚ä»¥æ­¤è¿›è¡Œå¾ªç¯ï¼Œç›´åˆ°æ”¶æ•›ã€‚ ä¸€ç§enhancementçš„æ–¹æ¡ˆï¼ŒResidual PMMï¼š

![1CFB1038-9A72-4100-8B9A-A9AA267F81D0](assets/1CFB1038-9A72-4100-8B9A-A9AA267F81D0.png)

å®éªŒç»“æœå¯è§†åŒ–ï¼š

![image-20210630172056147](assets/image-20210630172056147.png)





---

#### Prior Guided Feature Enrichment Network for Few-Shot Segmentation

ã€TPAMI 2020ã€‘

æ¨¡å‹åç§°ï¼šPFENet æ–‡ç« æå‡ºäº†few shot segçš„ä¸¤ä¸ªproblemï¼šgeneralization loss due to misuse of high-level featuresï¼›ä»¥åŠspatial inconsistency between support and queryã€‚ æœ¬æ–‡çš„ä¸»è¦æ€è·¯å³ç”Ÿæˆä¸€ä¸ªæ— é¡»è®­ç»ƒçš„prior heatmapï¼Œç„¶åç»“åˆsupport feature é€šè¿‡Feature enrichment moduleå¯¹query featureè¿›è¡Œadaptively refineã€‚ 

![25F4BE02-D4A3-47AF-92FD-2FC7D1B4A6C4](assets/25F4BE02-D4A3-47AF-92FD-2FC7D1B4A6C4.png)



Training free prior generation:ç”¨imagenetä¸Šè®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œä½œä¸ºç‰¹å¾æå–å™¨ï¼Œå¾—åˆ°supportå’Œqueryçš„ç‰¹å¾ï¼Œç„¶ååšcos simã€‚å–å‡ºqueryä¸­çš„æ¯ä¸ªç‰¹å¾ä¸supportä¸­æ‰€æœ‰ç‰¹å¾cos simæœ€å¤§çš„ï¼Œä½œä¸ºè¯¥ç‚¹å’Œsupportçš„correspondenceã€‚ç„¶åå½’ä¸€åŒ–åˆ°0-1ä¹‹é—´ï¼Œæˆäº†prior maskã€‚è¿™ä¸ªmaskä¸éœ€è¦åœ¨trainsetä¸Šè®­ç»ƒï¼Œä¿è¯ä¸ä¼šæ‹Ÿåˆåˆ°å·²çŸ¥çš„classç‰¹å¾ä¸Šã€‚ Hå’ŒMåˆ†åˆ«ä»£è¡¨é«˜é˜¶ç‰¹å¾å’Œä¸­é˜¶ç‰¹å¾ï¼Œç”±äºé«˜é˜¶ç‰¹å¾å®¹æ˜“æ‹Ÿåˆåˆ°å·²çŸ¥ç±»åˆ«ï¼Œè€Œè¿™æ˜¯ä¸æœŸæœ›çš„ï¼Œå› æ­¤ç”¨ä¸­é˜¶ç‰¹å¾è¿›è¡Œå¤„ç†ã€‚ Feature enrichment moduleç»“æ„å¦‚ä¸‹ï¼šï¼ˆFEMï¼‰ 

![455090E6-4A43-487C-BF60-B1E795531374](assets/455090E6-4A43-487C-BF60-B1E795531374.png)

å…¶ä¸­çš„Mä»£è¡¨merge æ¨¡å—ï¼Œå¦‚ä¸‹ï¼š

![image-20210630172736110](assets/image-20210630172736110.png)

ä¸è€ƒè™‘FEMï¼Œç½‘ç»œçš„pipelineå¦‚ä¸‹ï¼š

![429DD07D-766B-4272-BF70-DC509A954C80](assets/429DD07D-766B-4272-BF70-DC509A954C80.png)

---

#### Few-Shot Semantic Segmentation Augmented with Image-Level Weak Annotationsï¼ˆFSILï¼‰

ã€arxiv 2020ã€‘

2020 arxiv è¯¥æ–‡ç« çš„åŸºæœ¬æ€è·¯å°±æ˜¯åˆ©ç”¨å’Œsupport åŒç±»åˆ«çš„weak annotationï¼Œå®é™…ä¸Šå°±æ˜¯image levelæ ‡æ³¨ä½œä¸ºè¾…åŠ©ï¼ŒåŠ å…¥n way k shotçš„è®­ç»ƒå’Œæµ‹è¯•ä¸­ï¼Œå¦‚å›¾ï¼š

![2CE13A77-C9F6-4027-A7C3-D854D8D528E2](assets/2CE13A77-C9F6-4027-A7C3-D854D8D528E2.png)

éœ€è¦é¢„æµ‹çš„ä¸ºğŸ‘ï¼Œå› æ­¤éœ€è¦æœ‰å¯¹ç¾Šçš„fine-grained maskã€‚è€Œå¢åŠ çš„è¾…åŠ©setåªæœ‰ç¾Šçš„å›¾ç‰‡ï¼Œå³å›¾åƒç±»åˆ«å·²çŸ¥ï¼Œç„¶åå°†supportå’Œauxiliaryè¿›è¡Œmergeï¼Œå­¦ä¹ ä¸€ä¸ªæ›´å¥½çš„è¡¨ç¤ºã€‚åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦ç”¨åŒæ ·çš„æ–¹å¼ï¼Œç»™å‡ºmaskå’Œauxiliary setã€‚ è¯¥æ–¹æ³•çš„åç§°ä¸ºFew Shot Image Levelã€‚ç»“åˆimage levelçš„ä¸»è¦issueåœ¨äºimage levelå’Œsegmentation levelçš„ä¸åŒï¼Œä»¥åŠimageä¸­objectå¯èƒ½æ¯”è¾ƒåˆ†æ•£ï¼Œä½ç½®ä¸å›ºå®šã€‚

![1FADFD74-6816-4430-87B1-B61B2B56E319](assets/1FADFD74-6816-4430-87B1-B61B2B56E319.png)

å…·ä½“å®ç°æ–¹æ³•æ“ä½œæ­¥éª¤ï¼š é¦–å…ˆï¼Œå°†sup img, aux img, que imgéƒ½è¿‡ä¸€ä¸ªfeature extractorï¼Œå°†å¾—åˆ°çš„supportçš„featureè¿›è¡Œmask average poolingï¼Œå¾—åˆ°åˆå§‹çš„prototypeï¼Œç„¶åå°†è¯¥protoå’Œauxçš„feature mapè®¡ç®—è·ç¦»ç›¸ä¼¼åº¦ï¼Œç»“åˆè·ç¦»è¿›è¡ŒåŠ æƒï¼Œå¾—åˆ°fused prototypeï¼Œä¹Ÿå°±æ˜¯auxçš„pseudo mapé€‰å®šçš„weighted average of feature mapçš„prototypeä¸ä¹‹å‰çš„original prototypeçš„æ±‚å’Œã€‚å…¬å¼ï¼š 

![image-20210630190651339](assets/image-20210630190651339.png)

å…¶ä¸­ï¼Œå¾—åˆ°çš„fused prototypeè¿˜å¯ä»¥ç»§ç»­è¿›è¡Œcossimçš„è®¡ç®—ï¼Œå¾—åˆ°æ–°çš„dist mapï¼Œå¦‚æ­¤ï¼Œå³æ‰€è°“çš„IFMï¼Œiterative fusion modelã€‚è¿˜æœ‰ä¸€ä¸ªissueï¼Œå³è€ƒè™‘åˆ°èƒŒæ™¯åƒç´ å¹¶ä¸æ˜¯å•ä¸€çš„ä¸€ç±»ï¼Œè€Œå¯èƒ½åŒ…å«ç€ä¸å±äºè¿™ä¸ªç±»çš„å…¶ä»–ç±»åˆ«ï¼Œä»¥åŠå¯èƒ½å…·æœ‰æ— å‚è€ƒä»·å€¼çš„aux imgç­‰ç­‰ã€‚ä¸ºäº†é€‰æ‹©æœ‰æ•ˆçš„auxï¼Œä¸€ç§æ–¹æ¡ˆå°±æ˜¯é‡‡ç”¨distilled mask average poolingï¼Œè®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œå°†äºprototypeè·ç¦»å¤§äºè¯¥å€¼çš„ä¸¢å¼ƒã€‚IFMè¿™ä¸ªæ¨¡å—äº§å‡ºçš„å°±æ˜¯ä¸€ä¸ªfused prototypeã€‚ äº§å‡ºè¯¥prototypeä¹‹åï¼Œè€ƒè™‘åˆ°prototypeå·²ç»ç»è¿‡äº†ä¿®æ”¹ï¼Œä¸ºäº†ä¸è‡³äºä¸åŸæ¥çš„ç”±supportäº§ç”Ÿçš„ç›¸å·®å¤ªå¤šï¼Œå› æ­¤éœ€è¦å†å¢åŠ ä¸€ä¸ªä¸supportæ±‚dist mapçš„lossçº¦æŸã€‚å› æ­¤ï¼Œæœ€ç»ˆçš„æŸå¤±å‡½æ•°ä¸ºï¼š L = Lsup + Lqryã€‚ 

![1AA3ADCC-0352-4823-B41A-2F872202C4DC](assets/1AA3ADCC-0352-4823-B41A-2F872202C4DC.png)



















































































